cd soundmirror-phoneme-backend
cat > .github/workflows/deploy.yml << 'EOF'
name: Deploy to Railway
on:
  workflow_dispatch:
jobs:
  deploy:
    runs-on: ubuntu-latest
    strategy:
      fail-fast: false
      matrix:
        include:
          - {code: en, model: facebook/wav2vec2-large-xlsr-53-english}
          - {code: es, model: facebook/wav2vec2-large-xlsr-53-spanish}
          - {code: fr, model: facebook/wav2vec2-large-xlsr-53-french}
          - {code: de, model: facebook/wav2vec2-large-xlsr-53-german}
          - {code: it, model: facebook/wav2vec2-large-xlsr-53-italian}
          - {code: pt, model: facebook/wav2vec2-large-xlsr-53-portuguese}
          - {code: ja, model: jonatasgrosman/wav2vec2-large-xlsr-53-japanese}
          - {code: zh, model: jonatasgrosman/wav2vec2-large-xlsr-53-chinese-zh-cn}
          - {code: hi, model: jonatasgrosman/wav2vec2-large-xlsr-53-hindi}
          - {code: ar, model: jonatasgrosman/wav2vec2-large-xlsr-53-arabic}
    steps:
      - uses: actions/checkout@v3
      - run: npm i -g @railway/cli
      - run: railway up
        env:
          RAILWAY_TOKEN: ${{ secrets.RAILWAY_TOKEN }}
      - run: |
          railway variables set MODEL_ID="${{ matrix.model }}" LANGUAGE=${{ matrix.code }}
        env:
          RAILWAY_TOKEN: ${{ secrets.RAILWAY_TOKEN }}
EOF
git add . && git commit -m "simplify" && git push
